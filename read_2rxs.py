import matplotlib
matplotlib.use('TkAgg')
import matplotlib.pyplot as plt
import numpy as np
from astropy.io import fits
import pandas as pd
if __name__=='__main__':
    #sources = np.loadtxt("heasarc_rass2rxs.tdat", skip_header=360, delimiter='|',filling_values=-99.)

    cols = """entry_number name skyfield_number skyfield_source_number detection_likelihood counts counts_error count_rate count_rate_error exposure ra dec lii bii lambda beta source_extent source_extent_error source_extent_prob hardness_ratio_1 hardness_ratio_1_error hardness_ratio_2 hardness_ratio_2_error unique_flag extended_region_flag nearby_src_det_flag source_quality_flag max_amplitude mean_count_rate mean_count_rate_error lc_counts min_count_rate min_count_rate_error max_count_rate max_count_rate_error lc_chi2 excess_variance excess_variance_error excess_variance_sigma nh_gal plaw_nh plaw_nh_error plaw_norm plaw_norm_error plaw_photon_index plaw_photon_index_error plaw_count_rate plaw_flux plaw_chi2_reduced plaw_chi2 plaw_number_data_pts plaw_dof mekal_nh mekal_nh_error mekal_norm mekal_norm_error mekal_temperature mekal_temperature_error mekal_count_rate mekal_flux mekal_chi2_reduced mekal_chi2 mekal_number_data_pts mekal_dof bb_nh bb_nh_error bb_norm bb_norm_error bb_temperature bb_temperature_error bb_count_rate bb_flux bb_chi2_reduced bb_chi2 bb_number_data_pts bb_dof x_pixel x_pixel_error y_pixel y_pixel_error x_sky_pixel y_sky_pixel extraction_radius extraction_radius_frac total_photons bkg_in_extr_reg vignetting_factor remarks band_a_tot_counts band_b_tot_counts band_c_tot_counts band_d_tot_counts band_a_bkg_counts band_b_bkg_counts band_c_bkg_counts band_d_bkg_counts remaining_bkg_area band_a_counts band_b_counts band_c_counts band_d_counts xmmsl1_number_ctrprts xmmsl1_nearest xmmsl1_separation xmmsl1_name xmmsl1_ra xmmsl1_dec xmmsl1_bb_count_rate xmmsl1_bb_count_rate_err xmmsl1_sb_count_rate xmmsl1_sb_count_rate_err threexmm_number_ctrprts threexmm_nearest threexmm_separation threexmm_name threexmm_ra threexmm_dec threexmm_count_rate threexmm_count_rate_err threexmm_flux threexmm_flux_error tworxp_number_ctrprts tworxp_nearest tworxp_separation tworxp_name tworxp_ra tworxp_dec tworxp_count_rate tworxp_count_rate_error tworxp_exposure tworxp_obsid onerxs_number_ctrprts onerxs_nearest onerxs_separation onerxs_name onerxs_ra onerxs_dec onerxs_count_rate onerxs_count_rate_error onerxs_counts onerxs_counts_error onerxs_det_likelihood onerxs_exposure onerxs_hr_1 onerxs_hr_1_error onerxs_hr_2 onerxs_hr_2_error veron_number_ctrprts veron_nearest veron_separation veron_name veron_type veron_vmag veron_redshift veron_source_number veron_ra veron_dec tycho2_number_ctrprts tycho2_nearest tycho2_separation tycho2_ra tycho2_dec tycho2_source_number tycho2_vmag tycho2_bmag tycho2_tyc1_number tycho2_tyc2_number tycho2_tyc3_number bsc_number_ctrprts bsc_nearest bsc_separation bsc_ra bsc_dec bsc_vmag bsc_spect_type bsc_source_number hd_source_number hmxb_number_ctrprts hmxb_nearest hmxb_separation hmxb_name hmxb_alt_name hmxb_ra hmxb_dec hmxb_vmag lmxb_number_ctrprts lmxb_nearest lmxb_separation lmxb_name lmxb_alt_name lmxb_ra lmxb_dec lmxb_vmag atnf_number_ctrprts atnf_nearest atnf_separation atnf_name atnf_ra atnf_dec atnf_pulsar_type atnf_pulse_period fuhr_number_ctrprts fuhr_nearest fuhr_separation fuhr_name fuhr_ra fuhr_dec fuhr_source_number onesxps_number_ctrprts onesxps_nearest onesxps_separation onesxps_ra onesxps_dec onesxps_exposure onesxps_det_flag onesxps_total_det_flag onesxps_soft_det_flag onesxps_medium_det_flag onesxps_hard_det_flag onesxps_source_number onesxps_count_rate onesxps_count_rate_error onerxh_number_ctrprts onerxh_nearest onerxh_separation onerxh_name onerxh_ra onerxh_dec onerxh_count_rate onerxh_count_rate_error onerxh_exposure onerxh_snr flem_number_ctrprts flem_nearest flem_separation flem_name flem_ra flem_dec flem_type flem_wfc_detection_flag flem_count_rate flem_count_rate_error wdcat_number_ctrprts wdcat_nearest wdcat_separation wdcat_name wdcat_ra wdcat_dec wdcat_vmag wdcat_vsphot sdss_number_ctrprts sdss_nearest sdss_separation sdss_name sdss_ra sdss_dec sdss_lambda sdss_beta tworxs_number_ctrprts tworxs_nearest_src_num tworxs_nearest_src_index tworxs_separation tworxs_skyfield_number tworxs_skyfield_src_num tworxs_det_likelihood tworxs_count_rate tworxs_ra tworxs_dec tworxs_subfield_det_cell tworxs_nearby_flag tworxs_selected_bkg tworxs_x_pixel_sky_bkg1 tworxs_y_pixel_sky_bkg1 tworxs_x_pixel_sky_bkg2 tworxs_y_pixel_sky_bkg2 onerxs_bkg_count_rate tworxs_bkg_count_rate var_flag count_rate_6s count_rate_6s_error excess_var_6s excess_var_6s_error number_pts_in_lc number_pts_lessthan_6s number_pts_lessthan_1s number_pts_gtrthan_6s min_count_rate_6s max_count_rate_6s min_count_rate_6s_error max_count_rate_6s_error counts_notused_6 excess_var_lessthan_6 sum_count_rate_sigma spect_plot_flag lc_plot_flag clock_time clock_end_time time end_time""".split(' ')

    #print(set([x for x in cols if cols.count(x)>1]))
    sources = pd.read_csv("heasarc_rass2rxs.tdat", skiprows=355, sep='|', names=cols, low_memory=False)
    print(cols)
    print(sources)
    print(sources.keys())
    sources.to_hdf('rass2rxs.hdf5',key='df')
    
